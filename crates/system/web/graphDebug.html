<head>
  <!-- Plotly.js -->
   <script src="plotly-latest.min.js"></script>
</head>

<body>
  <div id="myDiv"><!-- Plotly chart will be drawn inside this DIV --></div>
  <script>
	var d3 = Plotly.d3;

	var WIDTH_IN_PERCENT_OF_PARENT = 100,
		HEIGHT_IN_PERCENT_OF_PARENT = 80;

	var gd3 = d3.select('body')
		.append('div')
		.style({
			width: WIDTH_IN_PERCENT_OF_PARENT + '%',
			'margin-left': (100 - WIDTH_IN_PERCENT_OF_PARENT) / 2 + '%',

			height: HEIGHT_IN_PERCENT_OF_PARENT + 'vh',
			'margin-top': (100 - HEIGHT_IN_PERCENT_OF_PARENT) / 2 + 'vh'
		});

	var gd = gd3.node();

	var x = [];
	var counter;
	var oldCounter = 0;
		
	var data = [{
		x: [],
		y: [],
		type: 'scattergl',
		color: 'blue'},
	{
		x: [],
		y: [],
		yaxis: 'y2',
		color: 'orange',
		type: 'scattergl'}
	];

	var layout = {
		font: {
			//family: 'Courier New, monospace',
			size: 30
		},
		xaxis: {title: 'time (s)'},
		yaxis: {
		  title: 'humidity',
		  titlefont: {color: 'blue'},
		  tickfont: {color: 'blue'},
		},
		yaxis2: {
		  title: 'temp',
		  titlefont: {color: 'orange'},
		  tickfont: {color: 'orange'},
		  overlaying: 'y',
		  side: 'right'
		}
	};
	
	//Plotly.newPlot(gd, data, layout);
  
	ws = new WebSocket("ws://192.168.1.4:80/ws")
	ws.binaryType = 'arraybuffer';
	
    ws.onmessage = function (evt)
    {
        //var yraw = new Float32Array(evt.data);
		//var y2 = yraw.slice(yraw.length/2);
		//var y1 = yraw.slice(0,yraw.length/2);

		console.dir(evt);
		
		//x.length = 0;
		//for (counter = oldCounter; counter < oldCounter+0.5*yraw.length/2; counter+=0.5) {
		//	x.push(counter);
		//}
		//oldCounter = counter;
		
		//Plotly.extendTraces(gd, {
		//	x: [x,x], 
		//	y: [Array.from(y1) ,Array.from(y2)]
		//  }, [0,1])
		  
		
	}
  </script>
</body>

//.map(function(x) { return x * 10; });
//document.getElementById('myDiv').innerHTML = JSON.stringify(yraw, null, 2);
